import{a as O,b as N,d as B,e as U,f as H}from"./chunk-HSVEJ4A5.js";import{b as F,c as A}from"./chunk-M6W3NZ6F.js";import{a as j,b as z}from"./chunk-I2XLL75Z.js";import{a as C,f as T,g as I}from"./chunk-YW6MCIL5.js";import{b as P}from"./chunk-24OTYQQH.js";import{v as S}from"./chunk-XXBXU6LL.js";import{da as D,ja as R,ma as L}from"./chunk-LKMVW7YE.js";import{Ca as x,Cb as b,Da as M,Ib as g,Pb as u,Qb as k,Yb as t,Zb as e,_b as p,cc as v,ed as _,fc as d,fd as E,hc as f,pb as c,pd as y,rc as i,tc as w,vb as s}from"./chunk-OVOXXI53.js";function W(m,n){if(m&1&&(t(0,"div")(1,"small"),i(2),e()()),m&2){let a=f();c(2),w("",a.uploadedFiles.length," file(s) selected")}}function X(m,n){if(m&1){let a=v();t(0,"div",31),d("click",function(){let l=x(a).index,o=f();return M(o.onMarkerClick(l))}),e()}if(m&2){let a=n.$implicit;k("left",a.x,"%")("top",a.y,"%")}}var V=class m{constructor(n,a){this.dialogRef=n;this.data=a}damageMarks=[];longPressTimeout;addMarker(n){let a=n.target;if(!a||a.tagName!=="IMG")return;let r=a.getBoundingClientRect(),l=0,o=0;if(n instanceof MouseEvent)l=(n.clientX-r.left)/a.clientWidth*100,o=(n.clientY-r.top)/a.clientHeight*100;else if(n instanceof TouchEvent){let h=n.touches[0]||n.changedTouches[0];l=(h.clientX-r.left)/a.clientWidth*100,o=(h.clientY-r.top)/a.clientHeight*100}l=Math.min(Math.max(l,0),100),o=Math.min(Math.max(o,0),100),console.log(`Marker added at X: ${l}% Y: ${o}%`),this.damageMarks.push({x:l,y:o})}uploadedFiles=[];onImageUpload(n){let a=n.target.files;this.uploadedFiles=Array.from(a),console.log(this.uploadedFiles)}removeMarker(n){this.damageMarks.splice(n,1)}onMarkerClick(n){this.removeMarker(n)}onMarkerLongPress(n){this.longPressTimeout=setTimeout(()=>{this.removeMarker(n)},500)}onMarkerRelease(){clearTimeout(this.longPressTimeout)}save(){this.dialogRef.close(this.damageMarks)}close(){this.dialogRef.close()}static \u0275fac=function(a){return new(a||m)(s(O),s(N))};static \u0275cmp=b({type:m,selectors:[["app-damage-marker"]],decls:76,vars:2,consts:[[1,"dialog-container"],[1,"scrollable-content"],[1,"title-container"],[1,"title"],[1,"form-row"],["appearance","outline"],["value","door"],["value","bumper"],["value","left"],["value","right"],["value","up"],["value","down"],["value","mixed"],["value","scratch"],["value","dent"],["value","low"],["value","high"],["value","used"],["value","new"],["matInput","","placeholder","e.g. AB 123 CD"],[1,"upload-section",2,"width","100%","margin-bottom","16px"],[2,"font-weight","500","margin-bottom","6px","display","block"],["type","file","multiple","","accept","image/*",2,"margin-bottom","8px",3,"change"],[4,"ngIf"],[1,"instructions"],[1,"image-container"],["src","assets/car-damage.png","alt","Car Image",2,"width","100%","height","auto","display","block",3,"click","touchstart"],["class","marker",3,"left","top","click",4,"ngFor","ngForOf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","",1,"add-btn",3,"click"],[1,"marker",3,"click"]],template:function(a,r){a&1&&(t(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2)(3,"h2",3),i(4,"Add Damage"),e()(),t(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i(8,"Car Part"),e(),t(9,"mat-select")(10,"mat-option",6),i(11,"Door"),e(),t(12,"mat-option",7),i(13,"Bumper"),e()()(),t(14,"mat-form-field",5)(15,"mat-label"),i(16,"Direction"),e(),t(17,"mat-select")(18,"mat-option",8),i(19,"Left"),e(),t(20,"mat-option",9),i(21,"Right"),e(),t(22,"mat-option",10),i(23,"Up"),e(),t(24,"mat-option",11),i(25,"Down"),e(),t(26,"mat-option",12),i(27,"Mixed"),e()()(),t(28,"mat-form-field",5)(29,"mat-label"),i(30,"Damage"),e(),t(31,"mat-select")(32,"mat-option",13),i(33,"Scratch"),e(),t(34,"mat-option",14),i(35,"Dent"),e()()()(),t(36,"div",4)(37,"mat-form-field",5)(38,"mat-label"),i(39,"Severity"),e(),t(40,"mat-select")(41,"mat-option",15),i(42,"Low"),e(),t(43,"mat-option",16),i(44,"High"),e()()(),t(45,"mat-form-field",5)(46,"mat-label"),i(47,"State of Car"),e(),t(48,"mat-select")(49,"mat-option",17),i(50,"Available"),e(),t(51,"mat-option",18),i(52,"Not Working"),e()()(),t(53,"mat-form-field",5)(54,"mat-label"),i(55,"License Plate"),e(),p(56,"input",19),e()(),t(57,"div",20)(58,"label",21),i(59," Upload Fuel/Mileage Image(s) "),e(),t(60,"input",22),d("change",function(o){return r.onImageUpload(o)}),e(),g(61,W,3,1,"div",23),e(),t(62,"p",24),i(63," Tap or click anywhere on the image to mark the damage."),p(64,"br"),i(65," On mobile/tablet, double-tap to mark."),p(66,"br"),i(67," Tap/click on the dot to delete! "),e(),t(68,"div",25)(69,"img",26),d("click",function(o){return r.addMarker(o)})("touchstart",function(o){return r.addMarker(o)}),e(),g(70,X,1,4,"div",27),e()()(),t(71,"mat-dialog-actions",28)(72,"button",29),d("click",function(){return r.close()}),i(73,"Cancel"),e(),t(74,"button",30),d("click",function(){return r.save()}),i(75,"Add"),e()()),a&2&&(c(61),u("ngIf",r.uploadedFiles.length>0),c(9),u("ngForOf",r.damageMarks))},dependencies:[y,_,E,S,I,T,C,z,j,D,A,F,L,R,P,H,U,B],styles:[`.dialog-container{width:500px;max-width:90vw;max-height:80vh;border-radius:10px!important;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;box-sizing:border-box;overflow:hidden}.title-container{display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:10px}.mat-dialog-content{height:100%;overflow-y:auto;padding:10px;box-sizing:border-box}.scrollable-content{max-height:calc(80vh - 120px);overflow-y:auto;padding:10px;width:100%}mat-icon{color:#272727!important}.upload-icon-title{color:#4a4a4a}.form-row{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;width:100%}.add-btn{color:#fff!important;background-color:#008dd2!important;margin-top:10px}.instructions{font-size:14px;font-style:italic;color:gray;text-align:center;margin:8px 0}.image-container{position:relative;display:flex;justify-content:center;align-items:center;width:100%}.image-container img{max-width:100%;height:auto;display:block}.marker{width:12px;height:12px;background-color:red;border-radius:50%;position:absolute;transform:translate(-50%,-50%);cursor:pointer;-webkit-user-select:none;user-select:none}.delete-marker-btn{position:absolute;top:-5px;right:-5px;width:16px;height:16px;background:#fff;color:#000;border-radius:50%;font-size:12px;display:flex;align-items:center;justify-content:center;padding:2px;cursor:pointer;border:none}@media (max-width: 850px){.dialog-container{width:80%;max-width:80vw;max-height:70vh;padding:15px}.scrollable-content{max-height:calc(70vh - 100px)}.form-row{grid-template-columns:1fr}.image-container{max-width:100%;margin:5px 0}.image-container img{width:100%}.instructions{font-size:13px;margin:5px 0}.add-btn{width:100%;margin-top:8px}}@media (max-width: 900px){.dialog-container{width:95%;max-width:95vw;max-height:60vh;padding:10px}.scrollable-content{max-height:calc(60vh - 80px)}.form-row{flex-direction:column;gap:6px}.image-container{max-width:100%}.image-container img{width:100%}.instructions{font-size:11px;margin:3px 0}.add-btn{width:100%;font-size:.9em;margin-top:5px}}.dialog-container .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-start,.dialog-container .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-gap,.dialog-container .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-end,.dialog-container .mat-form-field-appearance-outline.mat-focused .mat-form-field-label{color:#008dd2!important}
`],encapsulation:2})};export{V as a};
